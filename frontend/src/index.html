<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>
      Q-risq Analytics | Location Specific Hurricane Storm Surge &amp; Wind Data
    </title>
    <base href="/" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link
      rel="icon"
      type="image/x-icon"
      href="./assets/icons/qrisq-favicon-32x32.png"
    />
    <!-- <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAlHWmrd_KayZ_qN4vs07B3pysLQZ2Dq10&libraries=places&language=en"></script> -->
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCWrBf7hkK6LQdlv7ul98DzcyoFdF1OzLM&libraries=geometry,places&language=en"></script>
    <script src="./assets/environment.js"></script>
    <script src="./assets/lib/CanvasLayer.js"></script>
    <script src="./assets/lib/windy.js"></script>
    <script src="./assets/lib/tooltip.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/proj4js/2.3.3/proj4.js"></script>
    <!-- <script src="https://sdk.amazonaws.com/js/aws-sdk-2.2.32.min.js"></script> -->
    <script src="./assets/lib/shp2geojson/lib/jszip.js"></script>
    <script src="./assets/lib/shp2geojson/lib/jszip-utils.js"></script>
    <script src="./assets/lib/shp2geojson/lib/jszip-utils.js"></script>
    <script src="./assets/lib/elabel.js" type="text/javascript"></script>
    <script src="./assets/lib/pako.js" type="text/javascript"></script>
    <!-- <script type="text/javascript">
      AWS.config.region = 'us-east-1';
      AWS.config.credentials = new AWS.CognitoIdentityCredentials({
        IdentityPoolId: 'us-east-1:eb7e5361-02a5-4b2a-b8e0-786f0f24a850',
      });
      var lambda = new AWS.Lambda();
      var year_storm_advisory_utc_array = null;
      var most_recent_year_storm_advisory_utc_index = null;
      var storm_name;
      var advisory_date;
      function processAwsYearStormAdvisory() {
        var input;
        input = { utc: 'None' };
        lambda.invoke(
          {
            FunctionName: 'aws-lambda-list-objects',
            Payload: JSON.stringify(input),
          },
          function (err, data) {
            if (err) {
              console.log(err, err.stack);
            } else {
              var data_response = data.Payload;
              var data_response_values = data_response.split('|');
              year_storm_advisory_utc_array = new Array(
                data_response_values.length
              );
              for (
                var index = 0;
                index < data_response_values.length;
                index++
              ) {
                var year_storm_adv_points_filename = data_response_values[index]
                  .replace('"', '')
                  .replace('.json', '');
                var year_storm_adv_points_values = year_storm_adv_points_filename.split(
                  '-'
                );
                var year_storm_adv_points_text =
                  year_storm_adv_points_values[1] +
                  '; ' +
                  year_storm_adv_points_values[2] +
                  '; ' +
                  year_storm_adv_points_values[3] +
                  '; ' +
                  year_storm_adv_points_values[4];
                year_storm_advisory_utc_array[
                  index
                ] = year_storm_adv_points_text;
              }
              most_recent_year_storm_advisory_utc_index =
                data_response_values.length - 1;
              var selection_year_storm_adv_str =
                year_storm_advisory_utc_array[
                  most_recent_year_storm_advisory_utc_index
                ];
              var selection_year_storm_adv_str_parsed = selection_year_storm_adv_str.split(
                ';'
              );
              var aws_utc_str = selection_year_storm_adv_str_parsed[3].trim();
              var utc_aws_year_str = aws_utc_str.substring(0, 4);
              var utc_aws_month_str = aws_utc_str.substring(4, 6);
              var utc_aws_day_str = aws_utc_str.substring(6, 8);
              var utc_aws_hour_str = aws_utc_str.substring(8, 10);
              var utc_aws_min_str = aws_utc_str.substring(10);
              var aws_date_utc = new Date();
              aws_date_utc.setUTCFullYear(parseInt(utc_aws_year_str));
              aws_date_utc.setUTCMonth(parseInt(utc_aws_month_str) - 1);
              aws_date_utc.setUTCDate(parseInt(utc_aws_day_str));
              aws_date_utc.setUTCHours(parseInt(utc_aws_hour_str));
              aws_date_utc.setUTCMinutes(parseInt(utc_aws_min_str));
              aws_date_utc.setUTCSeconds(0);
              var d = new Date(Date.now());
              var year = d.getUTCFullYear();
              var month = d.getUTCMonth() + 1;
              var day = d.getUTCDate();
              var hour = d.getUTCHours();
              var minutes = d.getUTCMinutes();
              var seconds = d.getUTCSeconds();
              var year_str = String(year);
              var month_str = String(month);
              var day_str = String(day);
              var hour_str = String(hour);
              var min_str = String(minutes);
              var seconds_str = String(seconds);
              if (month_str.length == 1) {
                month_str = '0' + month_str;
              }
              if (day_str.length == 1) {
                day_str = '0' + day_str;
              }
              if (hour_str.length == 1) {
                hour_str = '0' + hour_str;
              }
              if (min_str.length == 1) {
                min_str = '0' + min_str;
              }
              if (seconds_str.length == 1) {
                seconds_str = '0' + seconds_str;
              }
              var utc_str = year_str + month_str + day_str + hour_str + min_str;
              var date_utc = new Date();
              date_utc.setUTCFullYear(parseInt(year_str));
              date_utc.setUTCMonth(parseInt(month_str) - 1);
              date_utc.setUTCDate(parseInt(day_str));
              date_utc.setUTCHours(parseInt(hour_str));
              date_utc.setUTCMinutes(parseInt(min_str));
              date_utc.setUTCSeconds(parseInt(seconds_str));
              var date_diff = date_utc - aws_date_utc;
              var hour_difference = date_diff / 1000.0 / 3600;
            }
          }
        );
        return;
      }
      function processAwsSetNHCStormNameTime() {
        var input;
        input = { utc: 'None' };
        lambda.invoke(
          {
            FunctionName: 'aws-lambda-point',
            Payload: JSON.stringify(input),
          },
          function (err, data) {
            if (err) {
              console.log(err, err.stack);
            } else {
              var data_decode = atob(data.Payload);
              var data_bin_gzd = pako.inflate(data_decode);
              var data_str = new TextDecoder('utf-8').decode(data_bin_gzd);
              var geojson_obj = JSON.parse(data_str);
              storm_name =
                geojson_obj['features'][0]['properties']['STORMNAME'];
              storm_name = storm_name.trim();
              var adv_num =
                geojson_obj['features'][0]['properties']['ADVISNUM'];
              var advisory_heading = 'Forecast Advisory: #' + adv_num.trim();
              var adv_date =
                geojson_obj['features'][0]['properties']['ADVDATE'];
              var adv_date_parsed = adv_date.split(' ');
              advisory_date =
                adv_date_parsed[4] +
                ' ' +
                adv_date_parsed[5] +
                ', ' +
                adv_date_parsed[6] +
                ' @ ' +
                adv_date_parsed[0].substring(0, adv_date_parsed[0].length - 2) +
                ':' +
                adv_date_parsed[0].substring(adv_date_parsed[0].length - 2) +
                ' ' +
                adv_date_parsed[1] +
                ' ' +
                adv_date_parsed[2];
              // var live_storm_header_div = document.createElement('div');
              // live_storm_header_div.id = 'header_div_id';
              // live_storm_header_div.style.width = '100%';
              // live_storm_header_div.style.height = '75px';
              // live_storm_header_div.style.padding = '0px 0px 0px 0px';
              // live_storm_header_div.style.margin = '0px auto 0px auto';
              // live_storm_header_div.style.backgroundColor = '#222222';
              // live_storm_header_div.style.color = 'white';
              // live_storm_header_div.style.zIndex = '0';
              // live_storm_header_div.className =
              //   'container clearfix et_menu_container';
              // live_storm_header_div.innerHTML =
              //   '<h1 style="color: white;">' +
              //   storm_name +
              //   '</h1>&nbsp' +
              //   advisory_date;
              // button_container_div_element.appendChild(live_storm_header_div);
            }
          }
        );
      }
      function OnScrollEvent() {
        var headElement = document.getElementsByTagName('title');
        var headElementInnerHTML = headElement.item(0).innerHTML;
        if (headElementInnerHTML == 'Live Storm | Q-risq Analytics') {
          var main_header_element = document.getElementById('main-header');
          main_header_element.setAttribute('class', 'et-fixed-header');
          var page_container_element = document.getElementById(
            'page-container'
          );
          page_container_element.setAttribute(
            'style',
            'padding-top: 138px; margin-top: -1px;'
          );
        }
      }
      function isEmpty(str) {
        return !str || 0 === str.length || !str.trim();
      }
      function ValidateEmail(inputText) {
        var mailformat1 = /^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/;
        var mailformat2 = /^(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*)@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:(2(5[0-5]|[0-4][0-9])|1[0-9][0-9]|[1-9]?[0-9]))\.){3}(?:(2(5[0-5]|[0-4][0-9])|1[0-9][0-9]|[1-9]?[0-9])|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])$/;
        if (
          inputText.length >= 6 &&
          inputText.match(mailformat1) &&
          inputText.match(mailformat2)
        ) {
          return true;
        } else {
          return false;
        }
      }
      function submit_test() {
        console.log('Submit Test called...');
        var wp_submit_elements = document.getElementsByClassName('wpcf7');
        var wp_submit_formRow_elements = wp_submit_elements
          .item(0)
          .getElementsByClassName('formRow');
        var wp_submit_formRow_name = wp_submit_formRow_elements.item(0);
        var wp_submit_formRow_email = wp_submit_formRow_elements.item(1);
        var wp_submit_formRow_text = wp_submit_formRow_elements.item(2);
        var wp_submit_name = wp_submit_formRow_name.getElementsByTagName(
          'input'
        );
        var wp_submit_email = wp_submit_formRow_email.getElementsByTagName(
          'input'
        );
        var wp_submit_text = wp_submit_formRow_text.getElementsByTagName(
          'textArea'
        );
        var contact_form_name = wp_submit_name.item(0).value;
        var contact_form_email = wp_submit_email.item(0).value;
        var contact_form_message = wp_submit_text.item(0).value;
        console.log('Name: ' + contact_form_name);
        console.log('Email:' + contact_form_email);
        console.log('Message:' + contact_form_message);
        var callout_elements = document.getElementsByClassName('callout');
        var callout_container_elements = callout_elements
          .item(0)
          .getElementsByClassName('callout-container');
        var callout_p_element = callout_container_elements
          .item(0)
          .getElementsByTagName('p');
        if (
          !isEmpty(contact_form_name) &&
          !isEmpty(contact_form_email) &&
          !isEmpty(contact_form_message)
        ) {
          contact_form_email = contact_form_email.trim();
          var valid_email = ValidateEmail(contact_form_email);
          if (valid_email == true) {
            var input_email;
            var status_code;
            input_email = {
              contact_form_email: contact_form_email,
              contact_form_name: contact_form_name,
              contact_form_message: contact_form_message,
            };
            lambda.invoke(
              {
                FunctionName: 'aws-lambda-contact-form-email',
                Payload: JSON.stringify(input_email),
              },
              function (err, data) {
                if (err) {
                  console.log(err, err.stack);
                  status_code = '500';
                } else {
                  var data_obj = JSON.parse(data.Payload);
                  status_code = data_obj['statusCode'];
                  var return_body = data_obj['body'];
                  console.log(status_code);
                  console.log(return_body);
                }
                if (status_code == '200') {
                  callout_p_element.item(0).innerHTML =
                    'Your email has been sent.';
                  callout_elements.item(0).style.visibility = 'visible';
                } else {
                  callout_p_element.item(0).innerHTML =
                    'Your email has NOT been sent. Please try again later.';
                  callout_elements.item(0).style.visibility = 'visible';
                }
              }
            );
          } else {
            callout_p_element.item(0).innerHTML =
              'The email address is invalid.';
            callout_elements.item(0).style.visibility = 'visible';
          }
        } else {
          console.log('Contact form is empty...');
          callout_p_element.item(0).innerHTML =
            'The contact form has one or more empty fields.';
          callout_elements.item(0).style.visibility = 'visible';
        }
      }
      function DOM_Loaded() {
        processAwsYearStormAdvisory();
        processAwsSetNHCStormNameTime();
      }
      document.addEventListener('DOMContentLoaded', DOM_Loaded);
      document.addEventListener('scroll', OnScrollEvent);
    </script> -->

    <!--[if IE]>
      <script
        type="text/javascript"
        src="./assets/lib/shp2geojson/lib/jszip-utils-ie.js"
      ></script>
    <![endif]-->

    <script src="./assets/lib/shp2geojson/preprocess.js"></script>
    <script src="./assets/lib/shp2geojson/preview.js"></script>
  </head>
  <body>
    <app-root></app-root>
  </body>
</html>
